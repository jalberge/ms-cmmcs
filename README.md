This repository contains code, instructions and data used to analyze and produce figures of:

**MinimuMM-seq: Genome sequencing of circulating tumor cells for minimally invasive molecular characterization of multiple myeloma pathology**

# Data analysis and figure generation

Code indexing per figure - Each Rmarkdown (.Rmd) file can be run within Rstudio, we also give matched intermediate markdown (.md) files which are human-readable in this github repo, and matched html files are generated from Rmd/md files. Chapters come with data and figures subfolders used by and generated by the R and Rmd files. Paper correspondance: irene_ghobrial@dfci.harvard.edu and gadgetz@broadinstitute.org.

## Data availability

Aggregated data are given in sub-data folders of each chapter. Sequencing data and complete phenotypes are stored at dbGAP under accession **phs003084.v1.p1**.

# Code for main figures

## Figure 1 (CTC enumeration)

This figure describes general enumeration results with data, code, and figures available in the `1_enumeration` folder

* Fig 1a: Workflow
* Fig 1b-d: `1_enumeration/enumeration_mgus_smm.Rmd`

## Figure 2 (Matched BMPC-CTC analysis)

This figure gathers general statistics on sequencing capability

* Fig 2a,b: Counts from enumeration and purity from ABSOLUTE: `2_wgs/2_overall_stats.Rmd`
* Fig 2d: Data, code, figures in `2_wgs/3_matched_CNV_tx.Rmd`

## Figure 3 (CTC only analysis)

This figures leverages blood-only samples and describe genomic landscape from there

* Fig 3a: Data, code, figures in `2_wgs/4_cmmc_only_CNV_tx.Rmd`
* Fig 3c,d code in `2_wgs/6_circos_plots_snv_sv_cnv.md` and functions for circos plots in `/0_utils/circos_utils.R`

## Figure 4 (Compared clonal architecture of matched CTCs and BMPCs and CTCs longitudinally)

* Fig 4ai: Pre/Post-phylogic clustering from `4_phylogic/1_post_clustering_SNVs_matched.md`
* Fig 4bi,ci: Pre/Post-phylogic clustering from `4_phylogic/2_post_clustering_SNVs_longitudinal_samples.md`

## Figure 6 (Mutational signatures and complex structural events)

* Fig 6a: Mutational processes in `3_signature_analyzer/2_aggregate_runs_and_replot_matrices.md`
* Fig 6b,6c,6d: `2_wgs/6_circos_plots_snv_sv_cnv.md` and functions for circos plots in `/0_utils/circos_utils.R`

# Code for supplementary figures

* Detailed WGS coverage and mutation detection sensitivity are available at `2_wgs/2_overall_stats.Rmd`
* Power analysis at `2_wgs/2_overall_stats.md`
* Matched signature analysis and cosine similarity in `3_signature_analyzer/2_aggregate_runs_and_replot_matrices.Rmd`
* Longitudinal heatmap and driver mutations in `2_wgs/7_heatmap_serial_wgs.md` and `4_phylogic/2_post_clustering_SNVs_longitudinal_samples.md#driver-mutations-over-time`
